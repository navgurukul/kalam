import{b9 as Z,bg as re,bh as N,aG as I,ba as d,bj as se,aS as e,aU as ee,a$ as ie,br as B,bn as oe,bo as ce,bp as de,bv as $,dh as ue,bs as G,by as Y,bz as T,bA as f,di as j,bF as W,bk as me,bq as pe,r as O,bD as E,bU as he,db as ge,bc as be,cC as fe,cD as ve,cE as ye,bi as we,bm as _e,be as xe,bd as Se}from"./vendor.5ff35c24.js";import{r as Ce,M as te,u as De,v as ke,w as Oe,x as Ae,y as J,z as Pe,A as M}from"./index.cb0640cd.js";import{a as P}from"./vendor_axios.5abceb0c.js";import"./vendor_core_js_pure.7f605738.js";import"./vendor_react_epic_spinners.792a5510.js";import"./vendor_mui_datatables.34fc80b0.js";import"./vendor_lodash.dde4158d.js";import"./vendor_react_slick.468a9aef.js";import"./vendor_react_easy_edit.886afc3d.js";import"./vendor_react_player.223b9460.js";const U="https://join.navgurukul.org/api/",K=[{value:"EnglishInterview",label:"English Interview Pending (2nd Round)"},{value:"AlgebraInterview",label:"Algebra Interview Pending (3rd Round)"},{value:"CultureFitInterview",label:"Culture Fit Interview Pending (4th Round)"}],Re=Z(c=>({container:{display:"flex",flexWrap:"wrap",flexDirection:"column",maxWidth:400},root:{maxWidth:450,margin:"auto",marginTop:"20px"},addIcon:{position:"absolute",marginLeft:"60%",top:"9px"},text:{marginBottom:c.spacing(1)},btn:{}})),Q=({updateOwners:c,isEdit:b,disabled:S,ownerData:m,ownerId:g})=>{const v=Re(),{enqueueSnackbar:y}=re(),{users:C}=N(t=>t.owners),[R,_]=I.useState(!1),[w,a]=I.useState({name:null,id:g!=null?g:null,availablity:"",stage:[],limit:0,gender:""}),p=async t=>{var D,k;const u=(D=(await P.get(`${U}owner/${t}`)).data)==null?void 0:D.data[0];a({name:u.user.mail_id,gender:(k=u.gender)!=null?k:"",availablity:u.available,stage:u.type,limit:u.max_limit,id:u.id})},n=()=>{const{name:t,gender:l,id:u,availablity:D,stage:k,limit:A}=w;if(m.some(L=>L.user.mail_id===t)){y(`${t} exists in owner dashboard.`,{variant:"error"});return}t&&u&&l&&k&&D!==""&&A>0?P.post(`${U}owner`,{user_id:u,available:D==="Yes",max_limit:A?parseInt(A,10):void 0,type:k,gender:parseInt(l,10)}).then(L=>{y("Owner Successfull created !",{variant:"success"}),_(!1),c(L.data.data[0],!1)}):y("Please fill all fields",{variant:"error"})},s=async()=>{_(!0),b&&await p(g)},r=(t,l)=>{_(!1),!l&&a({name:null,id:g!=null?g:null,availablity:"",stage:[],limit:0,gender:""})},i=()=>{const{name:t,gender:l,id:u,availablity:D,stage:k,limit:A}=w;t&&u&&l&&k&&D!==""&&A>0?P.put(`${U}owner/${u}`,{available:D,max_limit:parseInt(A,10),type:k,gender:parseInt(l,10)}).then(F=>{y("Owner Successfull updated!",{variant:"success"}),r(),c(F.data.data[0],!0)}).catch(F=>{console.error(F.message),y("Interviews limit  should not be 10",{variant:"error"}),_(!1)}):y("Please fill all fields",{variant:"error"})},h=t=>{t.target.name==="name"?a({...w,name:t.target.label,id:t.target.value}):a({...w,[t.target.name]:t.target.value})},o=t=>{const{target:{value:l}}=t;a({...w,stage:typeof l=="string"?l.split(","):l})},x=t=>{a(l=>({...l,stage:l.stage.filter(u=>u!==t)}))},{name:q,gender:ae,availablity:le,stage:H,limit:ne}=w;return d(se,{children:[b?e(ee,{disabled:S,onClick:s,children:e(ie,{})}):e(B,{variant:"contained",color:"primary",onClick:s,className:v.btn,disabled:S,children:"Add Owner"}),d(oe,{open:R,onClose:r,children:[e(ce,{children:"Add New Owner"}),d(de,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e($,{sx:{pt:"0.4rem"},children:e(ue,{name:"name",value:q,onChange:(t,l)=>h({target:{name:"name",label:l.label,value:l.value}}),options:C.map(t=>({value:t.id,label:t.user})),isOptionEqualToValue:(t,l)=>t.label===l,placeholder:"Select Owner",renderInput:t=>e(G,{label:"Select Owner",helperText:"Please Select Owner",...t})})}),d($,{children:[e(Y,{children:"Select Gender"}),d(T,{name:"gender",value:ae,onChange:h,placeholder:"Select Gender",label:"Select Gender",children:[e(f,{value:"",disabled:!0,children:"Select an Option"}),Object.entries(Ce).map(([t,l])=>e(f,{value:t,children:l},t))]}),e(j,{className:v.text,id:"my-helper-text",children:"Please select your gender"})]}),d($,{children:[e(Y,{children:"Select Availability"}),d(T,{name:"availablity",value:le,onChange:h,placeholder:"Select Availablity",children:[e(f,{value:"",disabled:!0,children:"Select an Option"}),[{value:!0,label:"Yes"},{value:!1,label:"No"}].map(({value:t,label:l})=>e(f,{value:t,children:l},t))]}),e(j,{className:v.text,id:"my-helper-text",children:"Select Yes/No"})]}),d($,{children:[e(Y,{children:"Select Stage"}),d(T,{name:"stage",label:"Select Stage",placeholder:"Select Stage",value:H,multiple:!0,onChange:o,renderValue:t=>e(W,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:t.map(l=>e(me,{onMouseDown:u=>{u.stopPropagation()},label:K.find(u=>u.value===l).label,onDelete:()=>x(l)},l))}),children:[e(f,{value:"",disabled:!0,children:"Select an Option"}),K.filter(({value:t})=>!H.includes(t)).map(({label:t,value:l})=>e(f,{value:l,children:t},l))]}),e(j,{className:v.text,id:"my-helper-text",children:"Stage select kariye jo aap owner ko assign karna chahate ho."})]}),e(G,{type:"number",id:"limit",name:"limit",label:"Interview Limit",placeholder:"Interview Limit",value:ne,onChange:h,helperText:"Ek student kitne interviews le sakta hai."})]}),d(pe,{children:[e(B,{variant:"outlined",color:"primary",onClick:r,children:"Cancel"}),e(B,{variant:"contained",color:"primary",onClick:b?i:n,className:v.btn,disabled:b&&!q,children:`${b?"Update":"Add"} Owner`})]})]})]})},V="https://join.navgurukul.org/api/",X=c=>E(c,"hh:mm").format("hh:mm A"),Be=c=>E(c).format("D MMM YYYY"),Te=c=>c!=null&&c.trim()?e("a",{href:c,target:"_blank",rel:"noopener noreferrer",children:"Join Meet"}):"\u2014";function Fe(c){const{scheduleOpen:b,setScheduleOpen:S}=c,[m,g]=O.exports.useState([]),[v,y]=O.exports.useState(new Date),C=O.exports.useCallback(n=>{const s=E(n);if(!s.isValid())return;const r=s.format("YYYY-MM-DD");P.get(`${V}/slot/interview/ondate/${r}`).then(({data:i})=>{const h=i.data.map(o=>{var x;return{...o,name:o.student.name,email:o.student.email,phone:o.contacts.mobile,owner:((x=o.user)==null?void 0:x.user_name)||"",meet_link:o.meet_link||" ",meet_link_status:o.meet_link_status,meet_call_status:o.meet_link_status===!0?"Present":o.meet_link_status===!1?"Absent":"",result_status:o.result_status===!0?"Pass":o.result_status===!1?"Fail":""}});y(r),g(h)})},[]),R=async(n,s)=>{const r=m[n].id,h=m[n].meet_call_status==="Present",o=s==="Pass";try{await P.put(`${V}/slot/interview/updateMeetStatus/${r}`,{meet_link_status:h,pass:o});const x=[...m];x[n].result_status=s,g(x)}catch(x){console.error("Error updating both statuses:",x),alert("Failed to update interview status. Please try again.")}},_=async(n,s)=>{const r=m[n].id,i=s==="Present";try{s==="Absent"&&await P.put(`${V}/slot/interview/updateMeetStatus/${r}`,{meet_link_status:i});const h=[...m];h[n].meet_call_status=s,h[n].meet_link_status=i,g(h)}catch(h){console.error("Error updating meet call status:",h),alert("Failed to update status. Please try again.")}},w=O.exports.useCallback(n=>{var r;const s=(r=m[n])==null?void 0:r.meet_call_status;return d(T,{value:s!==void 0?s:"",onChange:i=>_(n,i.target.value),size:"small",displayEmpty:!0,renderValue:i=>i||"Select",children:[e(f,{value:"",children:"Select"}),e(f,{value:"Present",children:"Present"}),e(f,{value:"Absent",children:"Absent"})]})},[m]),a=O.exports.useCallback(n=>{var i,h;if(((i=m[n])==null?void 0:i.meet_call_status)!=="Present")return"\u2014";const r=((h=m[n])==null?void 0:h.result_status)||"";return d(T,{value:r,onChange:o=>R(n,o.target.value),displayEmpty:!0,size:"small",renderValue:o=>o===""?"Select":o,children:[e(f,{value:"",children:"Select"}),e(f,{value:"Pass",children:"Pass"}),e(f,{value:"Fail",children:"Fail"})]})},[m]),p=[{name:"name",label:"Name",options:{filter:!1,sort:!1}},{name:"phone",label:"Phone No.",options:{filter:!1,sort:!1}},{name:"email",label:"Email",options:{filter:!1,sort:!1}},{name:"start_time",label:"Start Time",options:{filter:!1,sort:!1,customBodyRender:X}},{name:"end_time_expected",label:"Expected End Time",options:{filter:!1,sort:!1,customBodyRender:X}},{name:"on_date",label:"Date",options:{filter:!0,sort:!0,customBodyRender:Be}},{name:"owner",label:"Owner Name",options:{filter:!0,sort:!0}},{name:"topic_name",label:"Topic Name",options:{filter:!0,sort:!0}},{name:"meet_link",label:"Meet Link",options:{filter:!0,sort:!0,customBodyRender:Te}},{name:"meet_call_status",label:"Meet Call Status",options:{filter:!1,sort:!1,customBodyRenderLite:w}},{name:"result_status",label:"Result",options:{filter:!1,sort:!1,customBodyRenderLite:a}}];return O.exports.useEffect(()=>{C(v)},[C]),e(he,{open:b,onClose:()=>S(!1),sx:{height:"85%",marginTop:"1.4rem",width:"99%",mx:"1.2rem",overflow:"scroll"},children:d(ge,{sx:{py:"1.2rem",px:"0.8rem"},children:[e(be,{variant:"h3",textAlign:"center",fontWeight:"medium",children:"Interview Schedule"}),d(W,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(W,{sx:{display:"flex",justifyContent:"center"},children:e(fe,{dateAdapter:ve,children:e(ye,{margin:"normal",format:"MM/dd/yyyy",value:E(v),onChange:n=>C(n),renderInput:n=>e(G,{...n})})})}),e(te,{title:"Schedule",columns:p,data:m})]})]})})}const $e=Z(()=>({innerTable:{marginLeft:"3vw",marginRight:"3vw",width:"80vw",marginTop:"5",marginBottom:"5",[M.breakpoints.up("md")]:{margin:"auto",marginTop:5,marginBottom:5}},buttons:{display:"flex",gap:M.spacing(2),margin:M.spacing(2)}})),z={defaultValue:"#F0E5D8",EnglishInterview:"#FFC478",AlgebraInterview:"#EFB7B7",CultureFitInterview:"#75CFB8"},Ge=()=>{const c=$e(),b=we(),{loggedInUser:S,privileges:m}=N(a=>a.auth),{ownerData:g}=N(a=>a.owners),{isFetching:v}=N(a=>a.ui),[y,C]=I.useState(!1),R=[{name:"id",label:"Edit",options:{filter:!1,sort:!1,customBodyRender:I.useCallback((a,p)=>{const n=(S==null?void 0:S.mail_id)||null,s=m.some(i=>i.privilege==="UpdateOwner")||p.rowData[1]===n,r=(m.some(i=>i.privilege==="DeleteOwner")||p.rowData[1]===n)&&p.rowData[4]===0;return d("div",{style:{display:"flex",margin:"10px",justifyContent:"space-between"},children:[e(Q,{ownerId:a,isEdit:!0,disabled:!s,updateOwners:_}),e(ee,{disabled:!r,onClick:()=>b(De({title:`Do you want to delete owner ${p.rowData[1].mail_id} ??`,actions:e(B,{onClick:()=>{w(a),b(ke())},color:"primary",variant:"contained",children:"Confirm"})})),children:e(_e,{color:r?"error":"",style:{cursor:"pointer"}})})]})},[])}},{name:"user",label:"Name",options:{filter:!0,sort:!0,customBodyRender:a=>a.mail_id}},{name:"gender",label:"Gender",options:{filter:!0,sort:!0,customBodyRender:a=>a===1?"Female":a===2?"Male":a===3?"Transgender":"N/A"}},{name:"available",label:"Available",options:{filter:!0,sort:!1,customBodyRender:a=>a?"Yes":"No"}},{name:"pending_interview_count",label:"Pending Interviews",options:{filter:!1,sort:!0}},{name:"type",label:"Interview Types",options:{filter:!1,sort:!1,customBodyRender:a=>a.map(p=>z[p]?d("p",{style:{backgroundColor:z[p],textAlign:"center",borderRadius:"75px"},children:[" ",p," "]},p):d("p",{style:{backgroundColor:z.defaultValue,textAlign:"center",borderRadius:"75px"},children:[" ",p," "]},p))}},{name:"max_limit",label:"Assigned Interviews Limit",options:{filter:!1,sort:!0}}];O.exports.useEffect(()=>{b(Oe()),b(Ae())},[]);const _=(a,p)=>{if(p){const n=[...g],s=n.findIndex(i=>i.id===a.id),r={...n[s]};r.available=a.available,r.type=a.type,r.max_limit=a.max_limit,r.gender=a.gender,n[s]=r,b(J(n))}else b(J([a,...g]))},w=a=>{b(Pe({ownerId:a}))};return e(xe,{mt:2,children:e(Se,{theme:M,children:d("div",{className:c.innerTable,children:[d("div",{className:c.buttons,children:[e(Q,{disabled:!m.some(a=>a.privilege==="AddOwner"),updateOwners:_,ownerData:g}),e(B,{variant:"contained",color:"primary",onClick:()=>C(!0),className:c.btn,children:"Interview Schedule"})]}),e(Fe,{setScheduleOpen:C,scheduleOpen:y}),e(te,{title:"Owners",columns:R,data:g,showLoader:v})]})})})};export{Ge as default};
